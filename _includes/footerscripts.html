{% include signup-form.html %}

{% if page.permalink == 'index.html' %}
<script>
head.load(
  "{{ "/public/css/pegke-front.min.css" | prepend: site.baseurl }}",
  "{{ "/public/js/semanticjs.front.min.js" | prepend: site.baseurl }}"
);
head.ready(function () {
  $('#header').removeClass('box-shadow');
  $(window).scroll(function() {
    if ($(this).scrollTop() > 400) {
      $('#header').addClass('box-shadow');
    } else {
      $('#header').removeClass('box-shadow');
    }
  });
  if(! head.mobile) {
    $('#fullpage').fullpage({
      animateAnchor: true,
      scrollOverflow: true,
      navigationTooltips: ['Home', 'Benefits', 'Testimonials', 'Businesses', 'Contact'],
      navigation: true,
      navigationPosition: 'right',
      sectionsColor: ['#000', '#fff7c1', '#DEEEEB', 'ECF2F2', '#222222'],
    });
  }
});
</script>
{% elsif page.permalink == '/api/' %}
<script>
head.load(
  "{{ "/public/css/pegke-api.min.css" | prepend: site.baseurl }}",
  "{{ "/public/js/semanticjs.api.min.js" | prepend: site.baseurl }}"
);
head.ready(function () {
  $(document).ready(function() {
    $(".hashnav").scrollspy();
    $('.hashnav a').click(function() {
      $('.hashnav a').removeClass('active');
      $(this).addClass('active');
      $('html, body').animate({
        scrollTop: $($(this).attr('href')).offset().top - 80
      }, 200);
    });
  });
});
</script>
{% else %}
<script>
head.load(
  "{{ "/public/css/pegke-page.min.css" | prepend: site.baseurl }}",
  "{{ "/public/js/semanticjs.min.js" | prepend: site.baseurl }}"
);
</script>
{% endif %}

<script type="text/javascript">
head.ready(function () {
  $('.overlayp').remove();
  $('.cta, .ctal').click(function() {
    $('.ui.modal.signup').modal('show');
  });

  $.fn.api.settings.api = {
    'signup'  : 'https://dashboard.pegke.com/api/user/register',
    'support' : 'https://dashboard.pegke.com/api/user/register',
    'registermobile'  : 'https://dashboard.pegke.com/api/user/register'
  };

  $(document).ready(function() {
    $('.costs button').click(function() {
      $('.costs button').removeClass('positive');
      var selcur = $(this).attr('data-curr');
      $(this).addClass('positive');
      console.log(selcur);
      if( selcur == 'usd' ) {
        $('.currency').text('$');
        animateUpdate(1.00, 0.014, 3, 'amt');
      } else if( selcur == 'inr' ) {
        $('.currency').text('₹');
        animateUpdate(0.014, 1.00, 2, 'amt');
      }
    });

    if ($('#pegkestat').length) {
      var dt = new Date();
      $.getJSON( "/status.json", function( data ) {
        $('#lstmod').text(dt);
        var items = [];
        $.each( data.sstatus, function( key, val) {

        items.push( '<div class="item"> \
          <div class="right floated content"> \
          <div class="ui tiny green label">' + val + '</div> \
          </div> <i class="check large green icon"></i> \
          <div class="content">' + key + '</div></div>' );
        });

        $( "<div/>", {
          "class": "ui middle aligned divided list",
          html: items.join( "" )
        }).appendTo( "#pegkestat" );
        $('#lstmod').html(data.last_mod);
        $('#pegkestat').removeClass('loading');
      });
    }

    $('.entcosts button').click(function() {
      $('.entcosts button').removeClass('positive');
      var selcur = $(this).attr('data-curr');
      $(this).addClass('positive');
      if( selcur == 'usd' ) {
        $('.entcurrency').text('$');
        animateUpdate(1.00, 0.008, 3, 'entamt');
      } else if( selcur == 'inr' ) {
        $('.entcurrency').text('₹');
        animateUpdate(0.008, 0.62, 2, 'entamt');
      }
    });

    function animateUpdate(fromVal, toVal, roundVal, elm) {
      jQuery({ Counter: 0 }).animate({ Counter: toVal }, {
        duration: 1000,
        easing: 'swing',
        step: function () {
          $('.'+ elm).text(parseFloat(this.Counter).toFixed(roundVal));
        }
      });
    }
    var pathname = window.location.pathname;
    var desired = pathname.replace(/[^\w\s]/gi, '')
    $(".menu.right a, .mobilemenu a, .footer").each(function(index) {
      var ahref = ($(this).attr('href')) ? $(this).attr('href') : 'not';
      var thishref = ahref.replace(/[^\w\s]/gi, '');
      if (desired === thishref ) {
        $(this).addClass("active");
      }
    });
    $(window).scroll(function() {
      if ($(this).scrollTop() > 400) {
        $('.go-top').fadeIn(400);
      } else {
        $('.go-top').fadeOut(400);
      }
    });
    $('.go-top').click(function(e) {
      e.preventDefault();
      $('html, body').animate({scrollTop: 0}, 300);
    })
  });

  $('.menu .item').tab();

  $('.ui.dropdown').dropdown();
  $('.ui.checkbox').checkbox();
  $('.ui.accordion').accordion();
  $('.ui.sticky')
  .sticky({
    context: '#context',
    offset: 75
  });

  $('.special.card .image').dimmer({
    on: 'hover'
  });

  // $('.ui.label').popup();
  $('.rupee.icon').popup();
  $('.feature-list .item').popup();
  $('.tstack').popup();
  $('.ui.rating').rating();
  // setInterval(function(){
  //   $('.shape').shape('flip over');
  // }, 3000);
  $('.ui.form')
  .form({
    fields: {
      name: {
        identifier: 'name',
        rules: [{
          type: 'empty',
          prompt: 'Please enter your name'
        }]
      },
      phone: {
        identifier: 'phone',
        rules: [{
          type: 'minLength[10]',
          prompt: 'Your 10 digit Mobile Number'
        }, {
          type: 'number',
          prompt: 'Numbers Only'
        }, {
          type: 'maxLength[10]',
          prompt: 'Your 10 digit Mobile Number'
        }]
      },
      country: {
        identifier: 'country',
        rules: [{
          type: 'empty',
          prompt: 'Please chose your country'
        }]
      },
      email: {
        identifier: 'email',
        rules: [{
          type: 'email',
          prompt : 'Please enter a valid e-mail'
        }]
      },
      city: {
        identifier: 'city',
        rules: [{
          type: 'empty',
          prompt: 'Please enter your city'
        }]
      }
    },
    inline : true,
    on     : 'blur'
  })
  .api({
    method: 'post',
    action: 'signup'
  });

  $('#support')
  .form({
    fields: {
      email: {
        identifier: 'email',
        rules: [{
          type: 'email',
          prompt : 'Please enter a valid e-mail'
        }]
      },
      details: {
        identifier: 'details',
        rules: [{
          type: 'empty',
          prompt: 'Tell us your concern !!'
        }]
      },
    }
  })
  .api({
    method: 'post',
    action: 'support',
    dataType: 'jsonp',
    onResponse: function (response) {
      console.log(response);
    }
  });

  $('#sg-sup-form')
  .form({
    fields: {
      email: {
        identifier: 'sg-email',
        rules: [{
          type: 'email',
          prompt : 'Please enter a valid e-mail'
        }]
      }
    }
  })
  .api({
    method: 'post',
    action: 'registermobile'
  });

  $('.step .image, .stack .image, .lazy')
  .visibility({
    type       : 'image',
    transition : 'pulse',
    duration   : 1000
  })
  ;
  $('#hamb').click(function() {
    $('.ui.submenu.modal')
    .modal('show');
  });
  // $('#checkpoints').on('submit', function(e) {
  //   e.preventDefault();
  //   var el = $(this);
  //   $('#sbmit').addClass('loading');
  //   // el.addClass.attr('disabled', "true");
  // });
  $('#sg-signup').click(function() {
    $(this).addClass('loading');
    $('#sg-email').attr('disabled', "true");

    setTimeout(function() {
      $('#sg-signup').removeClass('loading');
      $('#sg-email').removeAttr('disabled');
      $('#sg-msg').text('thanks...').removeClass('ohidden');
    }, 3000);

  });

  $('#checkpoints')
  .form({
    fields: {
      phone: {
        identifier: 'phone',
        rules: [{
          type: 'empty',
        }, {
          type: 'exactLength[10]',
        }, {
          type: 'number',
        }]
      },
      country: {
        identifier: 'country',
        rules: [{
          type: 'empty',
          prompt: 'Please chose your country'
        }]
      },
      // dob: {
      //   identifier: 'dob',
      //   rules: [{
      //     type: 'empty',
      //   },
      // {
      // type: 'regExp[/^d{2}([./-])d{2}1d{4}$/]'
      // }
      // ]
      // },
    }
  });

});

function submitForm() {
  alert('dfgdfg');
}
</script>
<script>(function(G,o,O,g,l){G.GoogleAnalyticsObject=O;G[O]||(G[O]=function(){(G[O].q=G[O].q||[]).push(arguments)});G[O].l=+new Date;g=o.createElement('script'),l=o.scripts[0];g.src='https://www.google-analytics.com/analytics.js';l.parentNode.insertBefore(g,l)}(this,document,'ga'));ga('create', 'UA-38015473-1', 'pegke.com');ga('require', 'displayfeatures');ga('set', '&uid', 0);ga('send', 'pageview')</script>
